<div class="grid-item">
  <div class="flip-card" id="flip_idea_{{ idea.id }}" idea_id="{{ idea.id }}">
    <!--CARD FRONT -->
    <div class="idea-card-front">
      <div class="front_card">
          <div class="card-icons">
          <div class="idea-gradient"></div>
            <span class="fa-stack fa-lg expand-icon show-for-large" expand_id="{{idea.id}}">
              <i class="fa fa-square fa-stack-2x"></i>
              <i class="fa fa-expand fa-stack-1x fa-inverse"></i>
            </span>
            <span class="fa-stack fa-lg turn-icon" turn_id="{{idea.id}}">
              <i class="fa fa-square fa-stack-2x"></i>
              <i class="fa fa-refresh fa-stack-1x fa-inverse"></i>
            </span>
          </div>

        {% if not idea.active %}
        <div class="status-unpublished">
          <p class"text-center">Noch nicht veröffentlicht</p>
        </div>
        {% endif %}

        {% if idea.picture %}
          {% if idea.title or idea.description %}<!--Bild und Titel oder Bild und Beschreibung-->
            <div class="idea-image" expand_id="{{ idea.id }}">
              <img src="{{ MEDIA_URL }}{{ idea.picture }}"> 
            </div>
            <div class="idea-details">
              <h2>{{ idea.title }}</h2>
              <p>{{ idea.description|urlizetrunc:25 }}</p>
              <!-- Das hier ist der schlimmste workaround ever seen, ich weiß. Mo -->
              <!--{% if idea.description|length < 100 and idea.picture %} 
                <p style="visibility:hidden;">{% lorem %}</p>
              {% endif %}
              {% if idea.description|length < 1000 and not idea.picture %}
                <p style="visibility:hidden;">{% lorem %}</p>
              {% endif %}-->
            </div>
          {% elif not idea.title and not idea.description %}<!--nur Bild-->
            <div class="idea-image" expand_id="{{ idea.id }}">
              <img src="{{ MEDIA_URL }}{{ idea.picture }}"> 
            </div>
            <!-- kleiner workaround: falls es nur ein Bild gibt, sorgt ein bissche unsichtbarer Text für die Mindestgröße der Karte-->
            <div class="idea-details">
              <p style="visibility: hidden;">{% lorem 5 w %}</p>
            </div>
          {% endif %}
        {% else %}<!-- kein Bild -->
          {% if idea.title and idea.description %}<!-- Titel und Beschreibung -->
              <div class="green-card">
                <h2>{{ idea.title }}</h2>
              </div>  
            <div class="idea-details">
              <p>{{ idea.description|urlizetrunc:25 }}</p>
            </div>
          {% endif %}
          {% if idea.title and not idea.description %}<!-- nur Titel -->
            <div class="green-card">
              <h2>{{ idea.title }}</h2>
            </div>
          {% endif %}
          {% if idea.description and not idea.title %}<!-- nur Beschreibung -->
            <div class="green-card">
              <p>{{ idea.description|urlizetrunc:25 }}</p>
            </div>
          {% endif %}
        {% endif %}


        {% if not request.user.is_authenticated %}
        <div class="card-notification-wrapper">
          <p id="login_{{ idea.id }}" class="card-notification" idea_id="{{ idea.id }}">Findest du gut? Zum Gutfinden <a href="{% url 'waitinglist' %}">melde dich an.</a></p>
        </div>
        {% endif %}

        <div class="row">
          <div id="do_comment_{{ idea.id }}" class="card-notification-wrapper">
          {% if do_comment %}
              <p id="login_{{ idea.id }}" class="card-notification" idea_id="{{ idea.id }}">Warum gefällt dir das? <a>Schreib es auf!</a></p>
          {% endif %}
          </div>
          <div id="id_heart_{{ idea.id }}" class="idea-heart" idea_id="{{ idea.id }}">
          <span class="fa-stack fa-lg">
            <i class="fa fa-heart fa-stack-2x" aria-hidden="true"></i>
            <strong class="fa-stack-1x" id="heart_{{ idea.id }}">{{ idea.likes.count }}</strong>  
          </span>
          </div>
        </div>
      </div>
    </div>
    <!-- END CARD FRONT -->

    <!--CARD BACK -->
    <div class="idea-card-back">
      <div class="back-hover-area">
        <div class="card-icons">
        <div class="idea-gradient"></div>
          <span class="fa-stack fa-lg expand-icon show-for-large" expand_id="{{idea.id}}">
            <i class="fa fa-square fa-stack-2x"></i>
            <i class="fa fa-expand fa-stack-1x fa-inverse"></i>
          </span>
          <span class="fa-stack fa-lg turn-icon" turn_id="{{idea.id}}">
            <i class="fa fa-square fa-stack-2x"></i>
            <i class="fa fa-refresh fa-stack-1x fa-inverse"></i>
          </span>
        </div>
      </div>
      <h2>{{ idea.title|truncatechars:17 }}</h2>
      <div class="idea-card-back-content">
        <div class="idea_comments" id="idea_comments_{{ idea.id }}" idea_id="{{ idea.id }}">
          {% for comment in idea.comments.all %}
          <div class="idea_comment" idea_id="{{ idea.id }}">
            <label>VOR {{ comment.date|timesince|upper }}{#  VON {{ user|upper }} #}</label>
            <p>{{ comment.message|urlizetrunc:25|escape|truncatechars:90 }}</p>
          </div>
          {% empty %} 
          <p class="white text-center" id="idea_comment_empty_{{idea.id}}">Es gibt noch keine Kommentare</p>
          {% endfor %}
        </div>
        <div class="idea_comment_more" id="idea_comment_more_{{idea.id}}"> <!-- Wenn es mehr als x Kommentare gibt -->
          <a href="{% url 'idea_detail' idea.pk %}">Alle {{ idea.comments.all|length }} Kommentare anzeigen</a>
        </div>
      </div>
        {% if request.user.is_authenticated %}
        <div class="comment-form">
        <p class="pull-left">Sag, was dir dazu einfällt!</p>
          <div class="idea_comment_form">
              <!--<div class="idea-heart-back" idea_id="{{ idea.id }}">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-heart fa-stack-2x" aria-hidden="true"></i>
                  <strong class="fa-stack-1x" id="heart_{{ idea.id }}">{{ idea.likes.count }}</strong>  
                </span>
              </div>-->
              <label class="pull-right">70 Zeichen übrig</label>
              <input autofocus="autofocus" class="idea_comment_input" id="idea_comment_{{idea.id}}" name="idea_comment" type="text"  />
              <a class="button expanded button--yellow button--icon idea_comment_button" id="idea_comment_button_{{ idea.id }}" idea_id="{{ idea.id }}">
                Kommentieren </a>
          </div>
        </div>
        {% else %}
        <p class="white text-center">Du willst was sagen? <a href="{% url 'waitinglist' %}">Melde dich an!</a></p>
        {% endif %}

    </div>
    <!-- END CARD BACK -->

  </div>
</div>