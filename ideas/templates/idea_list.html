{% extends "offcanvas.html" %}
{% load static sekizai_tags %}

{% block content %}

<br>

<div class="idea-callout">

<br><br>

<h3 class="text-center">Viele Projekte und noch mehr Ideen.</h3>
<p class="text-center">Es werden {{ idea_list.count| add:own_idea_list.count }} Ideen angezeigt. <a class="text-link-special" href="{% url 'create_idea' %}">Trag Deine eigene Idee ein.</a></p>
<p class="text-center">Oder <a class="text-link-special" href="{% url 'waitinglist' %}">registriere</a> dich.</p>

<br><br>

  <div class="grid">
      {% for idea in own_idea_list %}  
        {% include "idea_card.html" %}
      {% endfor %}
      {% for idea in idea_list %}  
        {% include "idea_card.html" %}
      {% endfor %}
  </div>

<br><br>
<p class="text-center"><a class="text-link-special" href="{% url 'create_idea' %}">Trag Deine eigene Idee ein.</a></p>

<br><br><br>

</div>

<br>

{% addtoblock 'js' %}

  <script type="text/javascript">

    var delay=150; // TODO das hier ist ein quick and dirty workaround....
    var $grid = $('.grid').masonry({
      columnWidth: 263,
      gutter: 30,
      itemSelector: '.grid-item',
      fitWidth: true,
      transitionDuration: '1s',
      stagger: 10,
    });

    $grid.imagesLoaded().progress( function() {
      $grid.masonry('layout');
    });

    $grid.on( 'click', '.idea-image', function( event ) {
      $( event.currentTarget ).parent().parent('.grid-item').toggleClass('is-expanded');
        setTimeout(function() {
        $grid.masonry();
        }, delay);
    });

    function like(object, idea_id, type) {
        post_to_url( "../like/", 
                    { idea_id : idea_id,
                      type: type },
                    function(data){
                        object.html(data);
                    });
      }

    $(".idea-heart").click(
      function()
      {
        var id = $(this).attr('idea_id');
        like($(this).find("#"+id), id, "like");
      });

    $(".idea-money").click(
      function()
      {
        var id = $(this).attr('idea_id');
        like($(this).find("#"+id), id, "money");
      });
    $(".idea-hand").click(
      function()
      {
        var id = $(this).attr('idea_id');
        like($(this).find("#"+id), id, "hand");
      });


  </script>

{% endaddtoblock %}


{% endblock content %}


