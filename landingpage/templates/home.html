{% extends "offcanvas.html" %}
{% load sekizai_tags static landingpage_tags idea_tags %}

{% block content %}

    <div class="lp-header full-height">
      <!--<img src="{% static 'img/symbole/noun_217781_cc.svg' %}">-->

      <div class="row">
        <div class="small-12 medium-10 large-10 columns small-centered text-center">
          <h1>Alle guten Ideen können wahr werden.</h1>
          <p class="pull-right"><em>Denn es fehlt ja weder an guten Ideen noch an guten Menschen...</em></p>
        </div>
      </div>
    </div>

  <div class="row">
    <div class="small-12 small-centered">
      <div class="callout">

        <h3 class="text-center">Wir sammeln alle guten Ideen der Welt.</h3>
        <p class="text-center">Und weil das allein nicht reicht, bauen wir eine <em>Plattform</em>, die dir hilft, deine Ideen auch umzusetzen. Du kannst schon jetzt was tun und deine <a class="text-link-special" href="{% url 'create_idea' %}">Idee für eine bessere Welt abgeben.</a></p>

          <div class="grid">
              {% idea_list as idea_list %}
              {% for idea in idea_list %}  
                {% include "idea_card.html" %}
              {% endfor %}
          </div>

        <p class="text-center"><a class="button button--yellow" href="{% url 'create_idea' %}">Idee abgeben</a></p>
        <p class="text-center"><a class="text-link-special" href="{% url 'idea_list' %}">mehr Ideen angucken</a></p>

      </div>
    </div>
  </div>

{% addtoblock 'js' %}

  <script type="text/javascript">

    var delay=150; // TODO das hier ist ein quick and dirty workaround....
    var $grid = $('.grid').masonry({
      columnWidth: 263,
      gutter: 30,
      itemSelector: '.grid-item',
      fitWidth: true,
      transitionDuration: '1s',
      stagger: 10,
    });

    $grid.imagesLoaded().progress( function() {
      $grid.masonry('layout');
    });

    $grid.on( 'click', '.idea-image', function( event ) {
      $( event.currentTarget ).parent().parent('.grid-item').toggleClass('is-expanded');
        setTimeout(function() {
        $grid.masonry();
        }, delay);
    });

    function like(object, idea_id, type) {
        post_to_url( "{% url 'like' %}", 
                    { idea_id : idea_id,
                      type: type },
                    function(data){
                        object.html(data);
                    });
      }

    $(".idea-heart").click(
      function()
      {
        var id = $(this).attr('idea_id');
        like($(this).find("#"+id), id, "like");
      });

    $(".idea-money").click(
      function()
      {
        var id = $(this).attr('idea_id');
        like($(this).find("#"+id), id, "money");
      });
    $(".idea-hand").click(
      function()
      {
        var id = $(this).attr('idea_id');
        like($(this).find("#"+id), id, "hand");
      });


  </script>

{% endaddtoblock %}

{% endblock content %}